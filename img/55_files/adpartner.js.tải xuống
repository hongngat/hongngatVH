(function(){
	var doc=document;
	if(typeof(admAdchkShow)=='undefined'){
		var ck={
			setCookie: function(a, c, d, b, g, f) {
				(new Date).getTime();
				b = "" == b ? "/" : b;
				d = 0 == d || "" == d ? (new Date(+new Date + 864E5)).toGMTString() : (new Date(+new Date + 6E4 * d)).toGMTString();
				a = [a + "=" + escape(c)];
				for (var h in d = {
					expires: d,
					path: b,
					domain: g
				}) d[h] &&
					a.push(h + "=" + d[h]);
				return f && a.push("secure"), document.cookie = a.join(";"), !0
			},
			getCookie: function(a) {
				return 0 < document.cookie.length && (c_start = document.cookie.indexOf(a + "="), -1 != c_start) ? (c_start = c_start + a.length + 1, c_end = document.cookie.indexOf(";", c_start), -1 == c_end && (c_end = document.cookie.length), unescape(document.cookie.substring(c_start, c_end))) : ""
			}
		};
		var  chk=ck.getCookie('admpshow');
		var fnfirst=function(len){
			var rd=Math.floor(Math.random()*len);
			var chose='';
			if(rd==1){
				window.admAdchkShow=true;
				chose='a';
			}else{
				window.admAdchkShow=false;
				chose='d';
			}
			return chose;
		};
		if(chk==''){
			chk=fnfirst(3);
		}else{
			var arrchk=chk.split(',');
			if(arrchk.length==3){
				chk=fnfirst(3);
			}else{
				if(chk.indexOf('a')!=-1){
					chk+=',d';
					window.admAdchkShow=false;
				}else if(arrchk.length==2){
					chk+=',a';
					window.admAdchkShow=true;
				}else{
					chk+=','+fnfirst(2);
				}
			}
		}
		ck.setCookie('admpshow',chk,'','/','.'+document.domain);
	}
	window.showAdDFPvsAdm=function(arrBan){
		if(arrBan.length==1){
			document.write(arrBan[0].src);
		}else{
			if(admAdchkShow){
				for(var i=0,len=arrBan.length; i<len; i++){
					if(arrBan[i].type=='admicro'){
						doc.write(arrBan[i].src);
					}
				}
				
			}else{
				var arrBandfp=[];
				for(var i=0,len=arrBan.length; i<len; i++){
					if(arrBan[i].type!='admicro'){
						arrBandfp.push(arrBan[i].src);
					}
				}
				var len=arrBandfp.length;
				if(len>=1){
					var rd=Math.floor(Math.random()*len);
					doc.write(arrBandfp[rd]);
				}
				
			}
		}
	}
})();